#!/bin/bash
#This script is not used in Config v1.0 onwards
# starts logpanel, servers and namemanager


zenity --title "Are you sure?" --question --text "Are you sure you want to restart the GDA servers for $BEAMLINE?" --window-icon=question
SURE=$?
if [ $SURE == 1 ]; then
  exit
fi
notify-send -t 10000 "GDA Servers is starting..."


gda_start_logpanel

#gda_namemanager &

echo "Keep this window open, and you will see a pop-up when the restart has completed"

# ssh into ixx-control as gda which should then run the servers script locally there
cmd="ssh -v -o BatchMode=yes -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i /dls_sw/$BEAMLINE/software/gda_versions/var/${BEAMLINE}ssh.key gda2@$BEAMLINE-control"; export cmd
echo $cmd
$cmd


zenity --title "Start the Client?" --question --text "The GDA servers have restarted. Click OK to start the GDA Client." --window-icon=question
STARTCLIENT=$?
if [ $STARTCLIENT == 0 ]; then
  gdaclient
fi
