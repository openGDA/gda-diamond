#!/bin/bash

#Remember to export the correct library path of jprofiler:
#export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/home/xr56/usr/jprofiler5/bin/linux-x86

if [ ! -n "$BEAMLINE" ];
then
  echo "Please set BEAMLINE environment variable."
  exit 1
fi

export gdaLauncher=/dls_sw/$BEAMLINE/software/gda/plugins/uk.ac.gda.core/bin/gda

varDir=/dls_sw/$BEAMLINE/var
dataDir=/dls/$BEAMLINE
logDir=/dls_sw/$BEAMLINE/logs


#echo "Stop client with JProfile settings"
#$gdaLauncher --stop rcpclient


echo "Start Client"

#Using the GDA launcher to launch the RCP client
echo JAVA_OPTS="-Xms512m -Xmx1024m -XX:PermSize=182m -XX:MaxPermSize=786m --extra_vmargs_start -agentlib:jprofilerti=port=8852 -Xbootclasspath/a:/home/xr56/usr/jprofiler5/bin/agent.jar extra_vmargs_end" $gdaLauncher --vardir=$varDir --datadir=$dataDir --logsdir=$logDir --rcp_image=/dls_sw/$BEAMLINE/software/gda/client/gda-${BEAMLINE} --start rcpclient
JAVA_OPTS="-Xms128m -Xmx1024m -XX:PermSize=512m -XX:MaxPermSize=786m -XX:MaxHeapFreeRatio=70 -XX:+DisableExplicitGC --extra_vmargs_start -agentlib:jprofilerti=port=8852 -Xbootclasspath/a:/home/xr56/usr/jprofiler5/bin/agent.jar extra_vmargs_end" $gdaLauncher --vardir=$varDir --datadir=$dataDir --logsdir=$logDir --rcp_image=/dls_sw/$BEAMLINE/software/gda/client/gda-${BEAMLINE} --start rcpclient
