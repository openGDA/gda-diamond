#!/bin/bash

if [ ! -n "$BEAMLINE" ];
then
  echo "Please set BEAMLINE environment variable."
  exit 1
fi


echo GDA_CONFIG: $GDA_CONFIG

#export gdaLauncher=/dls_sw/$BEAMLINE/software/gda/plugins/uk.ac.gda.core/bin/gda
export gdaLauncher=/dls_sw/$BEAMLINE/software/gda/workspace_git/gda-core.git/uk.ac.gda.core/bin/gda
varDir=/dls_sw/$BEAMLINE/var
dataDir=/dls/$BEAMLINE
logDir=/dls_sw/$BEAMLINE/logs

export GDA_CONFIG=/dls_sw/i07/software/gda/config

#echo $gdaLauncher servers
#$gdaLauncher servers

echo Stop all server
$gdaLauncher --stop nameserver
$gdaLauncher --stop logserver
$gdaLauncher --stop eventserver
$gdaLauncher --stop objectserver


echo Restart all servers
echo $gdaLauncher nameserver
$gdaLauncher --vardir=$varDir --logsdir=$logDir nameserver

echo $gdaLauncher --vardir=$varDir --logsdir=$logDir logserver
$gdaLauncher --vardir=$varDir --logsdir=$logDir logserver

echo $gdaLauncher --vardir=$varDir --logsdir=$logDir eventserver
$gdaLauncher --vardir=$varDir --logsdir=$logDir eventserver


echo JAVA_OPTS="-Xms512m -Xmx2048m -XX:PermSize=182m -XX:MaxPermSize=786m -XX:+DisableExplicitGC" $gdaLauncher --vardir=$varDir --datadir=$dataDir --logsdir=$logDir objectserver
JAVA_OPTS="-Xms512m -Xmx2048m -XX:PermSize=182m -XX:MaxPermSize=786m -XX:+DisableExplicitGC" $gdaLauncher --debug --vardir=$varDir --datadir=$dataDir --logsdir=$logDir objectserver

