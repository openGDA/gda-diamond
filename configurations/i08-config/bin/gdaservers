#!/bin/bash
# starts logpanel, servers and namemanager

zenity --title "Are you sure?" --question --text "Are you sure you want to restart the GDA servers?" --window-icon=question
SURE=$?
if [ $SURE == 1 ]; then
  exit
fi
notify-send -t 10000 "GDA Servers are starting..."

#identify install folder and JAVA_HOME
source /dls_sw/i08/etc/i08_profile.sh

gdalog &

echo "Keep this window open, and you will see a pop-up when the restart has completed"

# ssh into i08-control as gda2 which should then run the servers script locally there
cmd="ssh -v -o BatchMode=yes -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i /dls_sw/i08/software/gda_versions/var/i08ssh.key gda2@i08-control"; export cmd
echo $cmd
$cmd

notify-send -t 10000 "GDA Servers started. Launch GDA client"

#zenity --title "Start the Client?" --question --text "The GDA servers have restarted. Click OK to start the GDA Client." --window-icon=question
#zenity --title "Start gdaclient" --question --text "The GDA servers have restarted. Start the GDA Client by typing gdaclient in the terminal." --window-icon=question
#STARTCLIENT=$?
#if [ $STARTCLIENT == 0 ]; then
#  gdaclient
#fi