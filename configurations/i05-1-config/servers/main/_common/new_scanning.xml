<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<!-- This starts a scanServlet which handles new style scan requests arriving over ActiveMQ -->
	<bean id="scanServlet" class="org.eclipse.scanning.server.servlet.ScanServlet" init-method="connect">
		<property name="broker" value="${gda.activemq.broker.uri}" />
	</bean>

	<!-- Start a ScanRequestPreprocessor, which can add information to or otherwise modify
		scan requests arriving from the client before they are run by the scan servlet -->
	<bean id="stagePreprocessor" class="uk.ac.diamond.daq.mapping.impl.MappingStagePreprocessor">
		<property name="activeFastScanAxis" value="smx" />
		<property name="activeSlowScanAxis" value="smy" />
	</bean>
	<!-- Preprocessors must be registered as OSGi services to be used by the scan servlet -->
	<bean class="gda.util.osgi.OSGiServiceRegister">
		<property name="class" value="org.eclipse.scanning.api.scan.process.IPreprocessor" />
		<property name="service" ref="stagePreprocessor" />
	</bean>

	<!-- Start a MandelbrotPreprocessor which will set the axis names used for positioning -->
	<bean id="mandelbrotPreprocessor" class="uk.ac.diamond.daq.mapping.impl.MandelbrotPreprocessor">
		<property name="realAxisName" value="smx" />
		<property name="imaginaryAxisName" value="smy" />
	</bean>
	<!-- Preprocessors must be registered as OSGi services to be used by the scan servlet -->
	<bean class="gda.util.osgi.OSGiServiceRegister">
		<property name="class" value="org.eclipse.scanning.api.scan.process.IPreprocessor" />
		<property name="service" ref="mandelbrotPreprocessor" />
	</bean>

</beans>
