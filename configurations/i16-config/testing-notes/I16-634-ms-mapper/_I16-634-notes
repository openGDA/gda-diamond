================================================================================
							Live testing with msmapper
================================================================================

Scan		Configuration	Dummy	Detector		Notes
			NDW	DWE	LF	T	/Live						Baseline scan command
----------- --- --- --	-	-----	-------	-------	----------------------------
1027742		NDW	DWE	LF		Live	NXPDW	pil3	scancn eta 0.001 31 MapperProc pil3_100k 1 roi2
1027743		NDW	DWE	LF		Live	NXPDW	pil3	scancn hkl [0.001, 0.001, 0.0] 31 MapperProc pil3_100k 1 roi2
1027744		NDW	DWE	LF		Live	NXPDW	merlin	scancn eta 0.001 31 MapperProc merlin 1 merlinroi2
1027745		NDW	DWE	LF		Live	NXPDW	merlin	scancn hkl [0.001, 0.001, 0.0] 31 MapperProc merlin 1 merlinroi2
----------- --- --- --	-	-----	-------	-------	----------------------------
1027749		NSD				Live	NXD/NDP	pil3	scancn eta 0.001 31 MapperProc pil3_100k 1
1027751		NSD				Live	NXD/NDP	pil3	scancn hkl [0.001, 0.001, 0.0] 31 MapperProc pil3_100k 1
----------- --- --- --	-	-----	-------	-------	----------------------------
	NDW		NexusDataWriter				T		Template
	NSD		NexusScanDataWriter			NXPDW	NxProcessingDetectorWrapper
	DWE		DataWriterExtender			NXD		NXDetector
	LF		Link Files					NDP		NexusDetectorProcessor

================================================================================
							Preparing for a scan
--------------------------------------------------------------------------------

These scans assumes you have done

loadub('Si')
pos euler [0, 90, 0, 0, 0, 0]	# chi 90, rest 0
con gam 0 mu 0 phi 9
simhkl [1 1 0]					# Check delta ~= 2*eta, chi ~= 90 & gamma/mu = 0
pos hkl [1 1 0]
pilin							# Before pil scans
merlinin						# Before merlin scans

and, as suggested in Dummy_mode_operation.txt, set the simulated area detector
to the correct image size.

--------------------------------------------------------------------------------
						Preparing a scan for archiving
--------------------------------------------------------------------------------

During setup, run this line instead

ARCHIVE=$DEPLOYMENT/config/testing-notes/example-eta-scan/I16-634-hkl-mapper/
BASELINELOG=$ARCHIVE/1027742.i16_msmapper.log

--------------------------------------------------------------------------------
						Finding the processed scans and logs
--------------------------------------------------------------------------------

The processed nexus files can be found in $VISIT/processed and their suffix is
_msmapper rather than -processed-volume-hkl

	To find the rs_map logs

grep -R "$SCAN.nxs is" tmp
cat > $VISIT/$SCAN.i16_msmapper.log < # Appending the file found

	To re-process data, or process data that wasn't automatically processed

rs_map -s 0.002 -o processing/ $SCAN.nxs > $SCAN.nxs.rs_map.log

--------------------------------------------------------------------------------
						Analysis
--------------------------------------------------------------------------------

	To compare the log with the baseline log:

[ -e $SCAN.i16_msmapper.log ] && kdiff3 $BASELINELOG $SCAN.i16_msmapper.log & \
[ -e $SCAN.nxs.rs_map.log   ] && kdiff3 $BASELINELOG $SCAN.nxs.rs_map.log &

	To generate the structure files of the processed volume:

nxls    -a processed/${SCAN}_msmapper.nxs > ${SCAN}_msmapper.nxs.nxlsa ; \
nexus.tree processed/${SCAN}_msmapper.nxs > ${SCAN}_msmapper.nxs.tree
---------- or ----------
nxls    -a processing/$SCAN-processed-volume-hkl.nxs > $SCAN-processed-volume-hkl.nxs.nxlsa ; \
nexus.tree processing/$SCAN-processed-volume-hkl.nxs > $SCAN-processed-volume-hkl.nxs.tree


cp *_msmapper.nxs.nxlsa *_msmapper.nxs.tree 

================================================================================