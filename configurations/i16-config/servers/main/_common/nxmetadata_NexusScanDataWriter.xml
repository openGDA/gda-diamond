<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans.xsd"
	profile="NexusScanDataWriter">

	<bean class="org.eclipse.scanning.device.NexusMetadataDevice" init-method="register">
		<property name="name" value="entry" /> <?ignore When a category node is the same type as the nexusClass, child nodes
														are added to it, rather than added as a child node with this name. ?>
		<property name="category" value="NX_ENTRY"/>
		<property name="nexusClass" value="NXentry"/>
		<property name="childNodes">
			<list>
				<bean class="org.eclipse.scanning.device.ScalarField">
					<property name="name" value="definition"/>
					<property name="value" value="NXmx" />
				</bean>
				<bean class="org.eclipse.scanning.device.ScalarField">
					<property name="name" value="features"/>
					<property name="value">
						<list>
							<value>3</value>
							<value>6</value>
							<value>-4539647395532570642</value>
						</list>
					</property>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="title_old"/>
					<property name="scannableName" value="_title"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="sample_name"/>
					<property name="scannableName" value="_sample"/>
				</bean>
			</list>
		</property>
	</bean>

	<bean id="source" class="org.eclipse.scanning.device.SourceNexusDevice" init-method="register">
		<property name="name" value="source" />
		<property name="sourceName" value="Diamond Light Source" />
		<property name="currentScannableName" value="rc" />
	</bean>

	<bean id="insertion_device" class="org.eclipse.scanning.device.InsertionDeviceNexusDevice" init-method="register">
		<property name="name" value="insertion_device" />
		<property name="type" value="WIGGLER" />
		<property name="gapScannableName" value="idgap" />
		<property name="harmonicScannableName" value="uharmonic" />
	</bean>

	<bean id="monochromator" class="org.eclipse.scanning.device.MonochromatorNexusDevice" init-method="register">
		<property name="name" value="monochromator" />
		<property name="energyScannableName" value="en" />
	</bean>

	<bean class="org.eclipse.scanning.device.NexusMetadataDevice" init-method="register">
		<property name="name" value="sample" />
		<property name="category" value="NX_INSTRUMENT"/>
		<property name="nexusClass" value="NXsample"/>
		<property name="childNodes">
			<list>
				<bean class="org.eclipse.scanning.device.ScalarField">
					<property name="name" value="depends_on"/>
					<property name="value" value="/entry/sample/transformations/phi"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableComponentField">
					<property name="name" value="surface_vector"/>
					<property name="scannableName" value="ubMeta"/>
					<property name="componentIndex" value="1"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableComponentField">
					<property name="name" value="unit_cell"/>
					<property name="scannableName" value="ubMeta"/>
					<property name="componentIndex" value="2"/>
					<property name="units" value="angstrom"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableComponentField">
					<property name="name" value="ub_matrix"/>
					<property name="scannableName" value="ubMeta"/>
					<property name="componentIndex" value="3"/>
				</bean>
			</list>
		</property>
	</bean>

	<bean id="beam" class="org.eclipse.scanning.device.BeamNexusDevice" init-method="register">
		<property name="name" value="beam" />
		<property name="incidentEnergyScannableName" value="en" /> <!-- incident_energy -->
		<property name="incidentBeamDivergenceScannableName" value="incidentBeamDivergenceScannable" />
		<property name="incidentPolarizationScannableName" value="incidentPolarizationScannable" />
		<property name="beamExtentScannableName" value="beamExtentScannable" />
		<property name="fluxScannableName" value="fluxScannable" />
		<property name="customNodes">
			<list>
				<bean class="org.eclipse.scanning.device.SpringExpressionField">
					<property name="name" value="incident_wavelength"/>
					<property name="expression" value="1e9 * 6.62606957e-34 * 299792458 / (@en.getPosition() * 1000 * 1.60217657e-19)"/>
					<!--                  wavelength = 1e9 * PLANCK *         LIGHTSPEED / (energy           * 1000 * EVOLT_TO_JOULE) -->
					<property name="units" value="nm"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="incident_polarisation_stokes"/>
					<property name="scannableName" value="incident_polarisation_stokes"/>
				</bean>
				<!-- vvvvvv Note that the beam direction transformation is specific to i16 vvvvvv -->
				<bean class="org.eclipse.scanning.device.ScalarField">
					<property name="name" value="depends_on"/>
					<property name="value" value="transformations/direction"/>
				</bean>
				<bean class="org.eclipse.scanning.device.GroupMetadataNode">
					<property name="name" value="transformations"/>
					<property name="nexusClass" value="NXtransformations"/>
					<property name="childNodes">
						<list>
							<bean class="org.eclipse.scanning.device.ScalarField">
								<property name="name" value="direction"/>
								<property name="value">
										<array value-type="java.lang.Double"><value>0.0</value></array>
								</property>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double"><value>0.</value><value>0.</value><value>1.</value></array>
											</constructor-arg>
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScalarField">
								<property name="name" value="reference_plane"/>
								<property name="value">
										<array value-type="java.lang.Double"><value>1.0</value></array>
								</property>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double"><value>1.</value><value>0.</value><value>0.</value></array>
											</constructor-arg>
										</bean>
									</list>
								</property>
							</bean>
						</list>
					</property>
				<!-- ^^^^^^ Note that the beam direction transformation is specific to i16 ^^^^^^ -->
				</bean> 
			</list>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.UserNexusDevice" init-method="register">
		<property name="name" value="user" />
	</bean>

	<bean class="org.eclipse.scanning.device.NexusMetadataDevice" init-method="register">
		<property name="name" value="attenuator" />
		<property name="category" value="NX_INSTRUMENT"/>
		<property name="nexusClass" value="NXattenuator"/>
		<property name="childNodes">
			<list>
				<bean class="org.eclipse.scanning.device.SpringExpressionField">
					<property name="name" value="attenuator_transmission"/>
					<property name="expression" value="@gains_atten.getPosition()[1]"/>
				</bean>
			</list>
		</property>
	</bean>

	<!-- Sample transform chain: . < kmu < kth < kap < kphi -->
	
	<bean class="org.eclipse.scanning.device.PositionerTransformationsAppender" init-method="register">
		<property name="name" value="cryophi" />
		<property name="transformation">
			<bean class="org.eclipse.scanning.device.Transformation">
				<property name="type" value="ROTATION" />
				<property name="dependsOn" value="entry/sample/transformations/phi" />
				<property name="size" value="0" />
				<property name="vector">
					<list>
						<value>0.567744</value>
						<value>-0.0003651</value>
						<value>0.82389</value>
					</list>
				</property>
			</bean>
		</property>
	</bean>
>>>>>>> b9edf82 I16-634 (9.33) Create sample transformations node using a template

	<bean class="org.eclipse.scanning.device.PositionerTransformationsAppender" init-method="register">
		<property name="name" value="kphi" />
		<property name="transformation">
			<bean class="org.eclipse.scanning.device.Transformation">
				<property name="type" value="ROTATION" />
				<property name="dependsOn" value="entry/sample/transformations/kappa" />
				<property name="size" value="0" />
				<property name="vector">
					<list>
						<value>0</value>
						<value>1</value>
						<value>0</value>
					</list>
				</property>
			</bean>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.PositionerTransformationsAppender" init-method="register">
		<property name="name" value="kap" />
		<property name="transformation">
			<bean class="org.eclipse.scanning.device.Transformation">
				<property name="type" value="ROTATION" />
				<property name="dependsOn" value="entry/sample/transformations/theta" />
				<property name="size" value="0" />
				<property name="vector">
					<list>
						<value>0</value>
						<value>0.64278761</value>
						<value>-0.76604443</value>
					</list>
				</property>
			</bean>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.PositionerTransformationsAppender" init-method="register">
		<property name="name" value="kth" />
		<property name="transformation">
			<bean class="org.eclipse.scanning.device.Transformation">
				<property name="type" value="ROTATION" />
				<property name="dependsOn" value="entry/sample/transformations/mu" />
				<property name="size" value="0" />
				<property name="vector">
					<list>
						<value>0</value>
						<value>1</value>
						<value>0</value>
					</list>
				</property>
			</bean>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.PositionerTransformationsAppender" init-method="register">
		<property name="name" value="kmu" />
		<property name="transformation">
			<bean class="org.eclipse.scanning.device.Transformation">
				<property name="type" value="ROTATION" />
				<property name="dependsOn" value="." />
				<property name="size" value="0" />
				<property name="vector">
					<list>
						<value>1</value>
						<value>0</value>
						<value>0</value>
					</list>
				</property>
			</bean>
		</property>
	</bean>

	<!-- Detector transform chain: . < gamma < delta < offsetdelta -->

	<bean class="org.eclipse.scanning.device.PositionerTransformationsAppender" init-method="register">
		<property name="name" value="delta_axis_offset" />
		<property name="transformation">
			<bean class="org.eclipse.scanning.device.Transformation">
				<property name="type" value="ROTATION" />
				<property name="dependsOn" value="entry/instrument/transformations/delta" />
				<property name="size" value="0" />
				<property name="vector">
					<list>
						<value>0</value>
						<value>-1</value> <!-- rotation is in opposite direction to delta -->
						<value>0</value>
					</list>
				</property>
			</bean>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.PositionerTransformationsAppender" init-method="register">
		<property name="name" value="kdelta" />
		<property name="transformation">
			<bean class="org.eclipse.scanning.device.Transformation">
				<property name="type" value="ROTATION" />
				<property name="dependsOn" value="entry/instrument/transformations/gamma" />
				<property name="size" value="0" />
				<property name="vector">
					<list>
						<value>0</value>
						<value>1</value>
						<value>0</value>
					</list>
				</property>
			</bean>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.PositionerTransformationsAppender" init-method="register">
		<property name="name" value="kgam" />
		<property name="transformation">
			<bean class="org.eclipse.scanning.device.Transformation">
				<property name="type" value="ROTATION" />
				<property name="dependsOn" value="." />
				<property name="size" value="0" />
				<property name="vector">
					<list>
						<value>1</value>
						<value>0</value>
						<value>0</value>
					</list>
				</property>
			</bean>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.NexusMetadataDevice" init-method="register">
		<property name="name" value="s1" />
		<property name="category" value="NX_INSTRUMENT"/>
		<property name="nexusClass" value="NXslit"/>
		<property name="childNodes">
			<list>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="x_gap"/>
					<property name="scannableName" value="s1xgap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="y_gap"/>
					<property name="scannableName" value="s1ygap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScalarField">
					<property name="name" value="depends_on"/>
					<property name="value" value="s1transformations/x_centre"/>
				</bean>
				<bean class="org.eclipse.scanning.device.GroupMetadataNode">
					<property name="name" value="s1transformations"/>
					<property name="nexusClass" value="NXtransformations"/>
					<property name="childNodes">
						<list>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="x_centre"/>
								<property name="scannableName" value="s1xcentre"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>1.</value>
														<value>0.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s1transformations/y_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="y_centre"/>
								<property name="scannableName" value="s1ycentre"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>1.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s1transformations/z_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScalarField">
								<property name="name" value="z_centre"/>
								<property name="value">
									<value type="java.lang.Double">-26.4</value>
								</property>
								<property name="units" value="m"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>0.</value>
														<value>1.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="." />
										</bean>
									</list>
								</property>
							</bean>
						</list>
					</property>
				</bean>
				<!-- ^^^^^^ slits transformation ^^^^^^ -->
			</list>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.NexusMetadataDevice" init-method="register">
		<property name="name" value="s2" />
		<property name="category" value="NX_INSTRUMENT"/>
		<property name="nexusClass" value="NXslit"/>
		<property name="childNodes">
			<list>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="x_gap"/>
					<property name="scannableName" value="s2xgap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="y_gap"/>
					<property name="scannableName" value="s2ygap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScalarField">
					<property name="name" value="depends_on"/>
					<property name="value" value="s2transformations/x_centre"/>
				</bean>
				<bean class="org.eclipse.scanning.device.GroupMetadataNode">
					<property name="name" value="s2transformations"/>
					<property name="nexusClass" value="NXtransformations"/>
					<property name="childNodes">
						<list>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="x_centre"/>
								<property name="scannableName" value="s2xcentre"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>1.</value>
														<value>0.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s2transformations/y_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="y_centre"/>
								<property name="scannableName" value="s2ycentre"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>1.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s2transformations/z_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScalarField">
								<property name="name" value="z_centre"/>
								<property name="value">
									<value type="java.lang.Double">-23.3</value>
								</property>
								<property name="units" value="m"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>0.</value>
														<value>1.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="." />
										</bean>
									</list>
								</property>
							</bean>
						</list>
					</property>
				</bean>
			</list>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.NexusMetadataDevice" init-method="register">
		<property name="name" value="s3" />
		<property name="category" value="NX_INSTRUMENT"/>
		<property name="nexusClass" value="NXslit"/>
		<property name="childNodes">
			<list>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="x_gap"/>
					<property name="scannableName" value="s3xgap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="y_gap"/>
					<property name="scannableName" value="s3ygap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScalarField">
					<property name="name" value="depends_on"/>
					<property name="value" value="s3transformations/x_centre"/>
				</bean>
				<bean class="org.eclipse.scanning.device.GroupMetadataNode">
					<property name="name" value="s3transformations"/>
					<property name="nexusClass" value="NXtransformations"/>
					<property name="childNodes">
						<list>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="x_centre"/>
								<property name="scannableName" value="s3xcentre"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>1.</value>
														<value>0.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s3transformations/y_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="y_centre"/>
								<property name="scannableName" value="s3ycentre"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>1.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s3transformations/z_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScalarField">
								<property name="name" value="z_centre"/>
								<property name="value">
									<value type="java.lang.Double">-17.3</value>
								</property>
								<property name="units" value="m"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>0.</value>
														<value>1.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="." />
										</bean>
									</list>
								</property>
							</bean>
						</list>
					</property>
				</bean>
			</list>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.NexusMetadataDevice" init-method="register">
		<property name="name" value="s4" />
		<property name="category" value="NX_INSTRUMENT"/>
		<property name="nexusClass" value="NXslit"/>
		<property name="childNodes">
			<list>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="x_gap"/>
					<property name="scannableName" value="s4xgap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="y_gap"/>
					<property name="scannableName" value="s4ygap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScalarField">
					<property name="name" value="depends_on"/>
					<property name="value" value="s4transformations/x_centre"/>
				</bean>
				<bean class="org.eclipse.scanning.device.GroupMetadataNode">
					<property name="name" value="s4transformations"/>
					<property name="nexusClass" value="NXtransformations"/>
					<property name="childNodes">
						<list>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="x_centre"/>
								<property name="scannableName" value="s4xcentre"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>1.</value>
														<value>0.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s4transformations/y_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="y_centre"/>
								<property name="scannableName" value="s4ycentre"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>1.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s4transformations/z_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScalarField">
								<property name="name" value="z_centre"/>
								<property name="value">
									<value type="java.lang.Double">-4.37</value>
								</property>
								<property name="units" value="m"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>0.</value>
														<value>1.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="." />
										</bean>
									</list>
								</property>
							</bean>
						</list>
					</property>
				</bean>
			</list>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.NexusMetadataDevice" init-method="register">
		<property name="name" value="s5" />
		<property name="category" value="NX_INSTRUMENT"/>
		<property name="nexusClass" value="NXslit"/>
		<property name="childNodes">
			<list>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="x_gap"/>
					<property name="scannableName" value="s5xgap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="y_gap"/>
					<property name="scannableName" value="s5ygap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScalarField">
					<property name="name" value="depends_on"/>
					<property name="value" value="s5transformations/x_centre"/>
				</bean>
				<bean class="org.eclipse.scanning.device.GroupMetadataNode">
					<property name="name" value="s5transformations"/>
					<property name="nexusClass" value="NXtransformations"/>
					<property name="childNodes">
						<list>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="x_centre"/>
								<property name="scannableName" value="s5xtrans"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>1.</value>
														<value>0.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s5transformations/y_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="y_centre"/>
								<property name="scannableName" value="s5ytrans"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>1.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s5transformations/z_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScalarField">
								<property name="name" value="z_centre"/>
								<property name="value">
									<value type="java.lang.Double">-0.5</value>
								</property>
								<property name="units" value="m"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>0.</value>
														<value>1.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="." />
										</bean>
									</list>
								</property>
							</bean>
						</list>
					</property>
				</bean>
			</list>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.NexusMetadataDevice" init-method="register">
		<property name="name" value="s6" />
		<property name="category" value="NX_INSTRUMENT"/>
		<property name="nexusClass" value="NXslit"/>
		<property name="childNodes">
			<list>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="x_gap"/>
					<property name="scannableName" value="s6xgap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="y_gap"/>
					<property name="scannableName" value="s6ygap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScalarField">
					<property name="name" value="depends_on"/>
					<property name="value" value="s6transformations/x_centre"/>
				</bean>
				<bean class="org.eclipse.scanning.device.GroupMetadataNode">
					<property name="name" value="s6transformations"/>
					<property name="nexusClass" value="NXtransformations"/>
					<property name="childNodes">
						<list>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="x_centre"/>
								<property name="scannableName" value="s6xtrans"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>1.</value>
														<value>0.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s6transformations/y_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="y_centre"/>
								<property name="scannableName" value="s6ytrans"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>1.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s6transformations/z_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScalarField">
								<property name="name" value="z_centre"/>
								<property name="value">
									<value type="java.lang.Double">57</value>
								</property>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>0.</value>
														<value>1.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="." />
										</bean>
									</list>
								</property>
							</bean>
						</list>
					</property>
				</bean>
			</list>
		</property>
	</bean>

	<bean class="org.eclipse.scanning.device.NexusMetadataDevice" init-method="register">
		<property name="name" value="s7" />
		<property name="category" value="NX_INSTRUMENT"/>
		<property name="nexusClass" value="NXslit"/>
		<property name="childNodes">
			<list>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="x_gap"/>
					<property name="scannableName" value="s7xgap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScannableField">
					<property name="name" value="y_gap"/>
					<property name="scannableName" value="s7ygap"/>
				</bean>
				<bean class="org.eclipse.scanning.device.ScalarField">
					<property name="name" value="depends_on"/>
					<property name="value" value="s7transformations/x_centre"/>
				</bean>
				<bean class="org.eclipse.scanning.device.GroupMetadataNode">
					<property name="name" value="s7transformations"/>
					<property name="nexusClass" value="NXtransformations"/>
					<property name="childNodes">
						<list>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="x_centre"/>
								<property name="scannableName" value="s7xtrans"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>1.</value>
														<value>0.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s7transformations/y_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScannableField">
								<property name="name" value="y_centre"/>
								<property name="scannableName" value="s7ytrans"/>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>1.</value>
														<value>0.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="s7transformations/z_centre" />
										</bean>
									</list>
								</property>
							</bean>
							<bean class="org.eclipse.scanning.device.ScalarField">
								<property name="name" value="z_centre"/>
								<property name="value">
									<value type="java.lang.Double">750</value>
								</property>
								<property name="units" value="mm"/>
								<property name="attributes">
									<list>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="transformation_type" />
											<constructor-arg name="value" value="translation" />
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="vector" />
											<constructor-arg name="value">
													<array value-type="java.lang.Double">
														<value>0.</value>
														<value>0.</value>
														<value>1.</value>
													</array>
											</constructor-arg>
										</bean>
										<bean class="org.eclipse.scanning.device.ScalarMetadataAttribute">
											<constructor-arg name="attrName" value="depends_on" />
											<constructor-arg name="value" value="." />
										</bean>
									</list>
								</property>
							</bean>
						</list>
					</property>
				</bean>
			</list>
		</property>
	</bean>

	<bean id="commonBeamlineDevicesConfiguration" class="org.eclipse.scanning.device.CommonBeamlineDevicesConfiguration">
		<property name="sourceName" value="source" />
		<property name="insertionDeviceName" value="insertion_device" />
		<property name="monochromatorName" value="monochromator" />
		<property name="beamName" value="beam" />
		<property name="userDeviceName" value="user" />
		<property name="additionalDeviceNames">
			<set>
				<value>attenuator</value>
				<value>entry</value>
				<value>sample</value>
			</set>
		</property>
	</bean>

	<!-- org.eclipse.dawnsci.nexus.scan.IDefaultDataGroupCalculator -->
	<bean id="nexusDefaultDataGroupName" class="org.eclipse.scanning.sequencer.nexus.DefaultDataGroupConfiguration">
		<property name="defaultDataGroupName" value="measurement" />
	</bean>

	<bean id="nexusDataWriterConfiguration" class="gda.data.scan.datawriter.NexusDataWriterConfiguration">
		<property name="nexusTemplateFiles">
			<list> <!-- Order here matters, as nodes can only be referenced after they have been created -->
				<value>${gda.config}/yaml/NXmx.yaml</value>
			</list>
		</property>
		<!-- The locationMap will work with both NexusDataWriter and NexusScanDataWriter, but is deprecated for the latter -->
		<property name="locationMap">
			<map>
				<entry key="frontend">
					<bean class="gda.data.scan.datawriter.scannablewriter.SingleScannableWriter">
						<property name="paths">
							<list>
								<value>instrument:NXinstrument/Frontend:NXcollection/frontendx</value>
							</list>
						</property>
					</bean>
				</entry>
				<entry key="x">
					<bean class="gda.data.scan.datawriter.scannablewriter.SingleScannableWriter">
						<property name="paths"
							value="test:NXcollection/x" />
					</bean>
				</entry>
			</map>
		</property>
		<!-- private Set<String> metadataScannables; -->
		<property name="metadataScannables">
			<set>
				<value>kgam</value>
				<value>kdelta</value>
				<value>delta_offset</value>
				<value>kap</value>
				<value>kphi</value>
				<value>kth</value>
				<value>kmu</value>
				<value>s1</value>
				<value>s2</value>
				<value>s3</value>
				<value>s4</value>
				<value>s5</value>
				<value>s6</value>
				<value>s7</value>
			</set>
		</property>
	</bean>
</beans>
