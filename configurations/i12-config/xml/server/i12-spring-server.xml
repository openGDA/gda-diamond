<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:corba="http://www.diamond.ac.uk/schema/gda/corba"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
           http://www.diamond.ac.uk/schema/gda/corba http://www.diamond.ac.uk/schema/gda/corba/gda-corba-1.0.xsd">

	<!-- Required beans for the framework -->

	<bean
		class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
		<property name="location"
			value="file:${gda.config}/properties/java.properties" />
	</bean>

	<bean class="gda.spring.FindableNameSetterPostProcessor" />

	<!-- Gda Required beans -->

	<bean id="GDAHashtable" class="gda.util.findableHashtable.FindableHashtable" />

	<bean id="SimpleServlet" class="gda.util.simpleServlet.FindableSimpleServlet" />

	<bean id="ScanDataStore" class="gda.util.simpleServlet.FindableSimpleServlet" />

	<bean id="Plot_Manager" class="gda.analysis.plotmanager.PlotManager" />

	<bean id="plot_server"
		class="uk.ac.diamond.scisoft.analysis.plotserver.PlotServerBase" />

	<!--
		<bean id="bcm"
		class="gda.server.beamlineConfigurationManager.BeamlineConfigurationManager"
		/>
	-->

	<bean id="FileRegistrar" class="gda.data.fileregistrar.FileRegistrar">
		<property name="name" value="FileRegistrar" />
		<property name="directory" value="/dls/bl-misc/dropfiles/icat/dropZone/i12/i12-" />
	</bean>

	<bean id="DefaultDataWriterFactory" class="gda.data.scan.datawriter.DefaultDataWriterFactory">
		<property name="name" value="DataWriterFactory" />
		<property name="dataWriterExtenders">
			<list>
				<ref bean="FileRegistrar" />
			</list>
		</property>
	</bean>


	<!-- Metadata Bean -->

	<bean id="GDAMetadata" class="gda.data.metadata.GdaMetadata">

        <property name="icat">
            <bean class="gda.data.metadata.icat.IcatConnectionDetails">
                <property name="name" value="icat" />
                <property name="url" value="jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS=(HOST=${oracle.host})(PROTOCOL=tcp)(PORT=${oracle.port}))(CONNECT_DATA=(SID=xe)))" />
                <property name="user" value="${icat.username}" />
                <property name="password" value="${icat.password}" />
                <property name="shiftTolerance" value="1440" />
                <property name="icatClassName" value="gda.data.metadata.icat.DLSIcat" />
            </bean>
        </property>

		<property name="metadataEntries">
			
			 <list>
                <bean class="gda.data.metadata.StoredMetadataEntry">
                    <property name="name" value="visit" />
                    <property name="defEntryName" value="defVisit" />
                </bean>
                <bean class="gda.data.metadata.PropertyMetadataEntry">
                    <property name="name" value="instrument" />
                    <property name="propertyName" value="gda.instrument" />
                </bean>
                
                <bean class="gda.data.metadata.PropertyMetadataEntry">
                    <property name="name" value="facility" />
                    <property name="propertyName" value="gda.facility" />
                </bean>
                
                <bean class="gda.data.metadata.PropertyMetadataEntry">
                    <property name="name" value="facilityType" />
                    <property name="propertyName" value="gda.facility.type" />
                </bean>
                
                <bean class="gda.data.metadata.PropertyMetadataEntry">
                    <property name="name" value="probe" />
                    <property name="propertyName" value="gda.facility.probe" />
                </bean>
			
			    <bean class="gda.data.metadata.EpicsMetadataEntry">
                    <property name="name" value="beamCurrent" />
                    <property name="pvName" value="SR-DI-DCCT-01:SIGNAL" />
                </bean>
                
                <bean class="gda.data.metadata.EpicsMetadataEntry">
                    <property name="name" value="facilityMode" />
                    <property name="pvName" value="CS-CS-MSTAT-01:MODE" />
                </bean>
                
                <bean class="gda.data.metadata.EpicsMetadataEntry">
                    <property name="name" value="fillMode" />
                    <property name="pvName" value="LI-TI-MTGEN-01:MODE" />
                </bean>
                
                <bean class="gda.data.metadata.PropertyMetadataEntry">
                    <property name="name" value="userid" />
                    <property name="propertyName" value="user.name" />
                </bean>
                
                <bean class="gda.data.metadata.StoredMetadataEntry">
                    <property name="name" value="federalid" />
                </bean>

				<bean class="gda.data.metadata.StoredMetadataEntry">
					<property name="name" value="subdirectory" />
					<property name="defEntryName" value="default" />
				</bean>


                <bean class="gda.data.metadata.IcatMetadataEntry">
                        <property name="name" value="investigation" />
                        <property name="query" value="id:investigation:id" />
                </bean>
			
				<bean class="gda.data.metadata.PropertyMetadataEntry">
                    <property name="name" value="defVisit" />
                    <property name="propertyName" value="gda.defVisit" />
                </bean>
                
                <bean class="gda.data.metadata.IcatMetadataEntry">
                    <property name="name" value="proposal" />
                    <property name="query" value="INV_NUMBER:investigation:id" />
                </bean>
                
                <bean class="gda.data.metadata.IcatMetadataEntry">
                    <property name="name" value="title" />
                    <property name="query" value="TITLE:investigation:id" />
                </bean>
                
                <bean class="gda.data.metadata.IcatMetadataEntry">
                    <property name="name" value="user" />
                    <property name="query" value="first_name, middle_name, last_name:facility_user where facility_user_id in (select facility_user_id from investigator:investigation_id" />
                </bean>
                
            </list>
			
		</property>
	</bean>

	<!-- Epics setup -->
	<bean class="gda.configuration.epics.EpicsConfiguration">
		<constructor-arg value="${gda.config}/xml/BL12I-gda-interface_22-10-2010.xml" />
	</bean>

	<!-- Device Beans -->

	<import resource="devices/dummies.xml" />

	<import resource="devices/ring.xml" />

	<import resource="devices/gbc1.xml" />

	<import resource="devices/monitors.xml" />

	<import resource="devices/mcs1.xml" />

	<!--
	MBRemoveMar2011
	
	<import resource="devices/s1.xml" />
	
	<import resource="live/mono_motors.xml" />
	<import resource="devices/mono.xml" /> 

	<import resource="live/t1_motors.xml" />
	<import resource="devices/t1.xml" />
	
	<import resource="live/ss1_motors.xml" />
	<import resource="devices/ss1.xml" />
	
	<import resource="live/t3_motors.xml" />
	<import resource="devices/t3.xml" />
	
	<import resource="live/t4_motors.xml" />
	<import resource="devices/t4.xml" />

	<import resource="devices/s2_new.xml" />

	MBRemoveMar2011
	--> 
    
	<import resource="devices/edxd.xml" />

	<!-- <import resource="devices/tfg2.xml" />-->

	<import resource="devices/scaler1.xml" />
	<import resource="I0eh1.xml"/>
	<import resource="I0oh2.xml"/>

	<import resource="devices/pco.xml" />

	<import resource="live/cam1_motors.xml" />
	<import resource="devices/cam1.xml" />
	
	<import resource="devices/filters.xml" />

	<import resource="devices/eurotherm.xml" />
	<import resource="live/pipediode.xml"/>
	
	<!--<import resource="devices/shutters.xml" />-->


	  <!--
	  MBRemoveMar2011
	<import resource="devices/pixium.xml" />
	  MBRemoveMar2011
	  -->
	 
	 <!-- external hutch devices -->
     <!--
	 
     <import resource="devices/s3.xml" />
	 <import resource="devices/ss2.xml" />
	 <import resource="devices/t5.xml" />
	 <import resource="devices/t7.xml" />
	 <import resource="devices/t8.xml" />
	<import resource="I0eh2.xml"/>
     -->


	<!-- Last thing to do, create the JythonServer -->

	<bean id="command_server" class="gda.jython.JythonServer">
		<property name="userScriptDirectory" value="${gda.users}/scripts/" />
		<property name="gdaScriptDirectory" value="${gda.config}/scripts/" />
		<property name="gdaScriptLibraryDirectory" value="${gda.root}/uk.ac.gda.core/scripts/" />
		<property name="gdaVarDirectory" value="${gda.config}/var/" />
		<property name="cacheDirectory" value="${gda.config}/var/jythonCache/" />
		<property name="remotePort" value="1236" />
	</bean>

	<corba:export namespace="i12server" />

</beans>
