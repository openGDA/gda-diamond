<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">

	<description>
		To use the Simulated Area detector in dummy mode:
			1) Launch the Utilities > GDA SWMR AreaDetector Simulation
				on the local machine and start the IOC.
			2) If you want to use an Area detector on another machine, or
				you are also launching the GDA servers, export the
				WORKSTATION environment variable with the short name for
				the machine the Simulation IOC is running on.
	</description>

	<!-- AD hardware -->

	<!-- Standard Area Detector plugins -->

	<bean id="cam2AD_cam" class="gda.spring.V17ADBaseFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:CAM:" />
	</bean>

	<bean id="cam2AD_arr" class="gda.spring.V17NDArrayFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:ARR:" />
	</bean>

	<bean id="cam2AD_stat" class="gda.spring.V17NDStatsFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:STAT:" />
	</bean>

	<bean id="cam2AD_roi" class="gda.spring.V17NDROIFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:ROI:" />
	</bean>

	<bean id="cam2AD_mjpg" class="gda.spring.V17FfmpegStreamFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:MJPG:" />
	</bean>

	<bean id="cam2AD_proc" class="gda.spring.V17NDProcessFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:PROC:" />
	</bean>

	<!-- Extended Area Detector plugins -->

	<bean id="cam2AD_roi1" class="gda.spring.V17NDROIFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:ROI1:" />
	</bean>

	<bean id="cam2AD__roi2" class="gda.spring.V17NDROIFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:ROI2:" />
	</bean>

	<bean id="cam2AD__roi3" class="gda.spring.V17NDROIFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:ROI3:" />
	</bean>

	<bean id="cam2AD__roi4" class="gda.spring.V17NDROIFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:ROI4:" />
	</bean>

	<bean id="cam2AD_roi5" class="gda.spring.V17NDROIFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:ROI5:" />
	</bean>

	<bean id="cam2AD_roi6" class="gda.spring.V17NDROIFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:ROI6:" />
	</bean>

	<bean id="cam2AD_stat1" class="gda.spring.V17NDStatsFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:STAT1:" />
	</bean>

	<bean id="cam2AD_stat2" class="gda.spring.V17NDStatsFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:STAT2:" />
	</bean>

	<bean id="cam2AD_stat3" class="gda.spring.V17NDStatsFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:STAT3:" />
	</bean>

	<bean id="cam2AD_stat4" class="gda.spring.V17NDStatsFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:STAT4:" />
	</bean>

	<bean id="cam2AD_stat5" class="gda.spring.V17NDStatsFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:STAT5:" />
	</bean>

	<bean id="cam2AD_stat6" class="gda.spring.V17NDStatsFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:STAT6:" />
	</bean>

	<bean id="cam2_NDFileTiff" class="gda.spring.V17NDFileFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:TIFF:" />
		<property name="resetToInitialValues" value="false" />
	</bean>

	<bean id="cam2_NDFileHDF5file" class="gda.spring.V17NDFileFactoryBean">
		<property name="prefix" value="${WORKSTATION:${HOSTNAME}}-AD-SIM-01:HDF5:" />
		<property name="resetToInitialValues" value="false" />
	</bean>

	<bean id="cam2_NDFileHDF5" class="gda.spring.V17NDFileHDF5FactoryBean">
		<property name="ndFileImpl" ref="cam2_NDFileHDF5file" />
		<property name="initialCompression" value="zlib" />
	</bean>

	<!-- NXDetector collection strategies -->

	<bean id="cam2_SingleExposureStandardCollectionStrategyBase" 
			class="gda.device.detector.addetector.collectionstrategy.ConfigureAcquireTimeDecorator">
		<property name="restoreAcquireTime" value="true"/>
		<property name="decoratee">
			<bean class="gda.device.detector.addetector.collectionstrategy.SingleImageModeDecorator">
				<property name="restoreNumImagesAndImageMode" value="true"/>
				<property name="decoratee">
					<bean class="gda.device.detector.addetector.collectionstrategy.InternalTriggerModeDecorator">
						<property name="restoreTriggerMode" value="true"/>
						<property name="decoratee">
							<bean class="gda.device.detector.addetector.collectionstrategy.SoftwareStartStop">
								<property name="adBase" ref="cam2AD_cam" />
								<property name="restoreAcquireState" value="true"/>
							</bean>
						</property>
					</bean>
				</property>
			</bean>
		</property>
	</bean>

	<bean id="cam2_SingleExposureStandardCollectionStrategy" class="gda.device.detector.addetector.collectionstrategy.ColourModeDecorator">
		<property name="restoreColourMode" value="true"/>
		<property name="colourMode" value="Mono"/>
		<property name="decoratee" ref="cam2_SingleExposureStandardCollectionStrategyBase"/>
	</bean>

	<bean id="cam2rgb_SingleExposureStandardCollectionStrategy" class="gda.device.detector.addetector.collectionstrategy.ColourModeDecorator">
		<property name="restoreColourMode" value="true"/>
		<property name="colourMode" value="RGB"/>
		<property name="decoratee" ref="cam2_SingleExposureStandardCollectionStrategyBase"/>
	</bean>

	<bean id="cam2_UESD_SingleExposureStandardCollectionStrategy" 
			class="gda.device.detector.addetector.collectionstrategy.UnsynchronisedExternalShutterDecorator">
		<property name="collectionExtensionTimeS" value="6"/>
		<property name="decoratee" ref="cam2_SingleExposureStandardCollectionStrategy" />
	</bean>

	<!-- NXDetector file writers -->

	<bean id="cam2_hdf5_MultipleImagesPerHDF5FileWriter"
			class="gda.device.detector.addetector.filewriter.MultipleImagesPerHDF5FileWriter">
		<property name="ndFileHDF5" ref="cam2_NDFileHDF5" />
		<property name="fileTemplate" value="%s%s%05d.hdf5" />
		<property name="filePathTemplate" value="$datadir$/$scan$" />
		<property name="fileNameTemplate" value="cam2-" />
		<property name="fileNumberAtScanStart" value="-1" />
		<property name="setChunking" value="false" />
		<property name="lazyOpen" value="true" />
	</bean>
	<!-- This generates files of the form $datadir$/$scan$/cam2.hdf5 -->

	<!-- SingleImagePerFileWriter(String detectorName)
	 -->
	<bean id="cam2_tiff_SingleImagePerFileWriter"
			class="gda.device.detector.addetector.filewriter.SingleImagePerFileWriter">
		<property name="ndFile" ref="cam2_NDFileTiff" />
		<property name="fileTemplate" value="%s%s%05d.tif" />
		<property name="filePathTemplate" value="$datadir$/$scan$/cam2" />
		<property name="fileNameTemplate" value="" />
		<property name="fileNumberAtScanStart" value="1" />
		<property name="keyNameForMetadataPathTemplate" value="cam2_path_template" />
	</bean>
	<!-- To generate files of the form $datadir$/$scan$-cam2-files/%05d.tif :
		<property name="fileTemplate" value="%s%s%05d.tif" />
		<property name="filePathTemplate" value="$datadir$/$scan$-cam2-files" />
		<property name="fileNameTemplate" value="" />
	-->

	<!-- NXDetectors -->

	<bean id="cam2rawNx" class="gda.device.detector.NXDetector">
		<property name="name" value="cam2rawNx" />
		<property name="collectionStrategy" ref="cam2_SingleExposureStandardCollectionStrategy" />
		<property name="additionalPluginList">
			<list>
				<ref bean="cam2_hdf5_MultipleImagesPerHDF5FileWriter" />
				<ref bean="cam2_tiff_SingleImagePerFileWriter" />
			</list>
		</property>
	</bean>

	<bean id="cam2rgbRawNx" class="gda.device.detector.NXDetector">
		<property name="name" value="cam2rbgRawNx" />
		<property name="collectionStrategy" ref="cam2rgb_SingleExposureStandardCollectionStrategy" />
		<property name="additionalPluginList">
			<list>
				<ref bean="cam2_hdf5_MultipleImagesPerHDF5FileWriter" />
				<ref bean="cam2_tiff_SingleImagePerFileWriter" />
			</list>
		</property>
	</bean>

	<!-- ADDetectors -->

	<bean id="cam2rawAD" class="gda.device.detector.addetector.ADDetector">
		<property name="adBase" ref="cam2AD_cam"/>
		<property name="collectionStrategy" ref="cam2_SingleExposureStandardCollectionStrategy" />
		<property name="ndFile"  ref="cam2_NDFileHDF5file"/>
		<property name="ndArray" ref="cam2AD_arr"/>
		<property name="ndStats" ref="cam2AD_stat"/>
		<property name="fileWriter" ref="cam2_hdf5_MultipleImagesPerHDF5FileWriter"/>
	</bean>

	<bean id="cam2rgbRawAD" class="gda.device.detector.addetector.ADDetector">
		<property name="adBase" ref="cam2AD_cam"/>
		<property name="collectionStrategy" ref="cam2rgb_SingleExposureStandardCollectionStrategy" />
		<property name="ndFile"  ref="cam2_NDFileHDF5file"/>
		<property name="ndArray" ref="cam2AD_arr"/>
		<property name="ndStats" ref="cam2AD_stat"/>
		<property name="fileWriter" ref="cam2_hdf5_MultipleImagesPerHDF5FileWriter"/>
	</bean>

	<bean id="cam2uesdRawAD" class="gda.device.detector.addetector.ADDetector">
		<property name="adBase" ref="cam2AD_cam"/>
		<property name="collectionStrategy" ref="cam2_UESD_SingleExposureStandardCollectionStrategy" />
		<property name="ndFile"  ref="cam2_NDFileHDF5file"/>
		<property name="ndArray" ref="cam2AD_arr"/>
		<property name="ndStats" ref="cam2AD_stat"/>
		<property name="fileWriter" ref="cam2_hdf5_MultipleImagesPerHDF5FileWriter"/>
	</bean>
</beans>