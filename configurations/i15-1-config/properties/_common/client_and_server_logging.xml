<?xml version="1.0" encoding="UTF-8"?>

<included>

    <!-- The include statement in the following java.properties file is not read so you need to reference both -->
    <property file="${gda.config}/properties/${gda.mode}/${gda.mode}_instance_java.properties" />
    <property file="${gda.config}/properties/_common/common_instance_java.properties" />

    <!-- include file is relative to the application directory -->

	<!-- Appender to send log messages to the log server -->
	<!-- http://logback.qos.ch/manual/appenders.html#SocketAppender -->
    <appender name="LogServer" class="ch.qos.logback.classic.net.SocketAppender">
        <RemoteHost>${gda.logserver.host}</RemoteHost>
        <Port>${gda.server.logging.port}</Port>
        <ReconnectionDelay>10000</ReconnectionDelay>
        <IncludeCallerData>true</IncludeCallerData>
    </appender>

	<!-- Wrap the Logserver appender with a AsyncAppender to ensure logging never reduces client or server performance
			http://logback.qos.ch/manual/appenders.html#AsyncAppender
			http://blog.takipi.com/how-to-instantly-improve-your-java-logging-with-7-logback-tweaks/ -->
	<appender name="logserver_async" class="ch.qos.logback.classic.AsyncAppender">
		<appender-ref ref="LogServer" />
		<queueSize>1000</queueSize>
		<discardingThreshold>0</discardingThreshold> <!-- This wont drop any messages unless the queue becomes full -->
		<neverBlock>true</neverBlock> <!-- If the message queue becomes full this will drop messages instead of blocking  -->
	</appender>
	<!-- Also AsyncAppender populates threadName in log message, so %thread in format works. -->

	<!-- Classes for which INFO messages are excessive
	 -->
	<logger name="uk.ac.diamond.scisoft.analysis.plotclient.PlotWindowManager">			<level value="ERROR"/></logger>

	<!-- Classes for which DEBUG messages are excessive
	 -->
	<logger name="org.apache.activemq.transport.AbstractInactivityMonitor">				<level value="INFO"/></logger>
	<logger name="org.eclipse.jetty.server">											<level value="INFO"/></logger>
	<logger name="org.eclipse.jetty.servlet">											<level value="INFO"/></logger>
	<logger name="org.eclipse.jetty.io">												<level value="INFO"/></logger>
	<logger name="org.eclipse.jetty.http">												<level value="INFO"/></logger>


	<!-- Classes for which TRACE messages are excessive
	 -->
	<logger name="gda.events.jms.JmsEventReceiver">										<level value="DEBUG"/></logger>
	<logger name="uk.ac.diamond.scisoft.analysis.io.HDF5Loader">           				<level value="DEBUG"/></logger>
	<logger name="hdf.hdf5lib.H5">														<level value="DEBUG"/></logger>
	<logger name="org.apache.activemq.ActiveMQMessageConsumer">							<level value="DEBUG"/></logger>
	<logger name="org.apache.activemq.ActiveMQSession">									<level value="DEBUG"/></logger>
	<logger name="org.apache.activemq.thread.PooledTaskRunner">           				<level value="DEBUG"/></logger>
	<logger name="org.apache.activemq.util.ClassLoadingAwareObjectInputStream">			<level value="DEBUG"/></logger>
</included>
